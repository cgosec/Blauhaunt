<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>BlauHaunt</title>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/basic/jquery.qtip.min.css" rel="stylesheet">
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap5-toggle@5.0.6/css/bootstrap5-toggle.min.css"
            rel="stylesheet"/>
    <link crossorigin="anonymous"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/fontawesome.min.css"
          integrity="sha512-SgaqKKxJDQ/tAUAAXzvxZz33rmn7leYDYfBP+YoMRSENhf3zJyx3SBASt/OfeQwBHA1nxMis7mM3EV/oYT6Fdw=="
          referrerpolicy="no-referrer" rel="stylesheet"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css"
          integrity="sha384-8wYGNo4TwC9xzqNRdt7OUN789eBPzNQlO/sxIKaJR1gkX0+Ok1kXxhHR4pZU+gP2" crossorigin="anonymous">
    <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
          referrerpolicy="no-referrer" rel="stylesheet"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script crossorigin="anonymous"
            referrerpolicy="no-referrer"
            src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap5-toggle@5.0.6/js/bootstrap5-toggle.jquery.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha512-TPh2Oxlg1zp+kz3nFA0C5vVC6leG/6mm1z9+mA81MI5eaUVqasPLO8Cuk4gMF4gUfP5etR73rgU/8PNMsSesoQ=="
            referrerpolicy="no-referrer"
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha512-3dZ9wIrMMij8rOH7X3kLfXAzwtcHpuYpEgQg1OA4QAob1e81H8ntUQmQm3pBudqIoySO5j0tHN4ENzA6+n2r4w=="
            referrerpolicy="no-referrer"
            src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha512-QWYhhlZXfhMzyiML+xSFHYINwLvLsVd2Ex6QKA4JQzulKAsXiHoNXN1gCgB7GUaVL8xGI9L6XXyqPJVLASVP7g=="
            referrerpolicy="no-referrer"
            src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.25.0/cytoscape.min.js"></script>
    <script crossorigin="anonymous"
            src="https://cdn.jsdelivr.net/npm/cytoscape-qtip@2.8.0/cytoscape-qtip.min.js"></script>

    <script crossorigin="anonymous"
            integrity="sha384-sIzeKWIAHvT0Vm8QbfLCqZwBG0WMCkWVAOYd/330YSNeeQ1Y57N3T9lQz5Ry/EHH"
            src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"
            integrity="sha384-hzexvprs0k2Q/IHSJOfegsjdg6kTcTTVxQdgHiB4+I/915hcvse9v42LLVVM5K4e"
            crossorigin="anonymous"></script>
    <script crossorigin="anonymous"
            src="https://cdn.jsdelivr.net/npm/desvg@1.0.2/desvg.min.js"></script>
    <link href="static/css/style.css" rel="stylesheet">
    <link href="static/css/dark-mode.css" rel="stylesheet">

</head>

<body style="height: 100%; margin: 0; overflow: hidden">
<div class="container-fluid vh-100">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse nav-fill" id="navbarNav">
                <div class="row w-100 justify-content-center">
                    <div class="col-4 justify-content-start">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <button class="btn btn-outline-primary" onclick="{
                                      document.getElementById('filterSideBar').classList.toggle('show')
                                        }" type="button">
                                    Filters
                                </button>
                            </li>
                            <li class="nav-item">
                                <div class="btn-group">
                                    <label data-bs-placement="bottom" data-bs-toggle="tooltip"
                                           title="Find a path from one System to an other">
                                        <button type="button" class="btn btn-outline-secondary" disabled>
                                            Path
                                        </button>
                                    </label>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="findPathBtn" role="button" type="button">
                                        <span class="sr-only"></span>
                                    </button>
                                    <div aria-labelledby="findPathBtn" class="dropdown-menu">
                                        <div>Find paths to system</div>
                                        <div class="">
                                            <label for="oldNodeName"></label><input type="text"
                                                                                    class="form-control cleanOnLoad"
                                                                                    id="findPathSrcSystem"
                                                                                    placeholder="SOURCE">
                                            <label for="newNodeName"></label><input type="text"
                                                                                    class="form-control cleanOnLoad"
                                                                                    id="findPathDstSystem"
                                                                                    placeholder="DESTINATION">
                                            <button class="btn btn-success"
                                                    onclick="findPathBtnClick(document.getElementById('findPathSrcSystem').value,
                                                    document.getElementById('findPathDstSystem').value)"
                                                    type="button">Find
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            <li class="nav-item">
                                <div class="btn-group">
                                    <button class="btn btn-outline-secondary" type="button" id="currentDisplayBtn"
                                            title="Render the current graph
click this after applying changes to the filter or the render menu"
                                            onclick="renderGraphBtnClick(null)">Render
                                    </button>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="currentDisplay" role="button"
                                            type="button" title="select visualization">
                                        <span class="sr-only"></span>
                                    </button>
                                    <div aria-labelledby="currentDisplay" class="dropdown-menu">
                                        <input autocomplete="off" checked="checked" class="btn-check render-radios"
                                               id="renderGraph"
                                               name="renderradio"
                                               type="radio" value="graph">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="renderGraph">Graph</label>
                                        <input autocomplete="off" class="btn-check render-radios" id="renderTimeline"
                                               name="renderradio"
                                               type="radio" value="timeline">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="renderTimeline">Timeline</label>
                                        <input autocomplete="off" class="btn-check render-radios" id="renderHeatmap"
                                               name="renderradio"
                                               type="radio" value="heatmap">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="renderHeatmap">Heatmap</label>
                                    </div>
                                </div>

                            </li>
                            <li class="nav-item">
                                <form name="graphStyle">
                                    <div class="btn-group" role="group">
                                        <input autocomplete="off" checked="checked" class="btn-check graphStyle"
                                               id="modeSystem"
                                               name="btnradio2"
                                               type="radio">
                                        <label class="btn btn-outline-secondary" for="modeSystem"
                                               title="show connections from system to system (users are the edges)">System</label>
                                        <input autocomplete="off" class="btn-check graphStyle" id="modeUser"
                                               name="btnradio2"
                                               type="radio">
                                        <label class="btn btn-outline-secondary" for="modeUser"
                                               title="show user to systems (users are the source node)">User</label>
                                    </div>
                                </form>
                            </li>
                        </ul>
                    </div>
                    <div class="col justify-content-center">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <div class="row">
                                    <div>Nodes:&nbsp<a id="nodesConter">0</a></div>
                                    <div>Edges:&nbsp&nbsp<a id="edgesCounter">0</a></div>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="btn-group" role="group">
                                    <button class="btn btn-outline-secondary" type="button" id="currentGraphBtn"
                                            title="Select the layout of the graph" disabled
                                    >GraphStyle
                                    </button>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="currentGraph" role="button"
                                            type="button">
                                        <span class="sr-only"></span>
                                    </button>
                                    <div class="dropdown-menu">
                                        <input autocomplete="off" checked="checked" class="btn-check" id="calculated"
                                               name="btnradio"
                                               type="radio">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="calculated">calculated</label>
                                        <input autocomplete="off" class="btn-check" id="modeGrid" name="btnradio"
                                               type="radio">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="modeGrid">grid</label>
                                        <input autocomplete="off" class="btn-check" id="modeCose" name="btnradio"
                                               type="radio">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="modeCose">cose</label>
                                        <input autocomplete="off" class="btn-check" id="modeCircle" name="btnradio"
                                               type="radio">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="modeCircle">circle</label>
                                        <input autocomplete="off" class="btn-check" id="modeTree" name="btnradio"
                                               type="radio">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="modeTree">tree</label>
                                        <input autocomplete="off" class="btn-check" id="modeConcentric" name="btnradio"
                                               type="radio">
                                        <label class="btn btn-outline-secondary dropdown-item"
                                               for="modeConcentric">concentric</label>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-outline-secondary" onclick="resolveIP2Host()"
                                            title="click here to resolve system names to their mapping - until you click no manual set hostnames nor automatically detected hostnames are applied">
                                        Resolve
                                    </button>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="nodeNamesBtn" role="button" type="button">
                                        <span class="sr-only"></span>
                                    </button>
                                    <div aria-labelledby="nodeNamesBtn" class="dropdown-menu">
                                        <div class="row-10">
                                            <button class="btn btn-secondary" type="button" id="trimNodeDomain"
                                                    title="Trim the domain from the node names"
                                                    onclick="trimDomainNodesNames()">
                                                Trim Domain
                                            </button>
                                        </div>
                                        <div class="dropdown-divider"></div>
                                        <div>Manually Rename</div>
                                        <div class="">
                                            <label for="oldNodeName"></label><input type="text" class="form-control"
                                                                                    id="oldNodeName"
                                                                                    placeholder="OLD NODE NAME">
                                            <label for="newNodeName"></label><input type="text" class="form-control"
                                                                                    id="newNodeName"
                                                                                    placeholder="NEW NODE NAME">
                                            <button class="btn btn-success"
                                                    onclick="replaceNodeNamesClick()"
                                                    title="Click Resolve to apply the changes"
                                                    type="button">Rename
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="btn-group">
                                    <button class="btn btn-outline-secondary" type="button" disabled>Tags</button>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="tagColorDropdown" role="button"
                                            type="button">
                                        <span class="sr-only"></span>
                                    </button>
                                    <div aria-labelledby="navbarDropdown" class="dropdown-menu cleanOnLoad"
                                         id="tagColorList">
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="col justify-content-end">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <div id="dataBtnWrapper">
                                    <button class="btn btn-secondary" data-bs-target="#UploadEVTX"
                                            data-bs-toggle="modal"
                                            type="button" id="uploadModalBtn">
                                        Upload
                                    </button>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="btn-group" id="casesBtnGrp">
                                    <button class="btn btn-outline-secondary" type="button">Cases</button>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="casesDropdown" role="button"
                                            type="button">
                                        <span class="sr-only"></span>
                                    </button>
                                    <ul aria-labelledby="navbarDropdown" class="dropdown-menu" id="caseDropdown">
                                        <li class=" dropdown-item">
                                            <div class="row">
                                                <label for="newCaseName"><input id="newCaseName" placeholder="Case Name"
                                                                                type="text"
                                                                                class="form-control"></label>
                                                <button class="btn btn-success mr-4"
                                                        onclick="{
                                storeDataToIndexDB(document.getElementById('newCaseName').value)
                                document.getElementById('case_list').innerHTML = ''
                                getCases()
                            }"
                                                        type="button">Save
                                                </button>
                                                <hr>
                                                <div id="case_list" class="row"></div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="btn-group">
                                    <button class="btn btn-outline-secondary" type="button" disabled>Export</button>
                                    <button aria-expanded="false" aria-haspopup="true"
                                            class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                                            data-bs-toggle="dropdown" id="navbarDropdown" role="button"
                                            type="button">
                                        <span class="sr-only"></span>
                                    </button>
                                    <div aria-labelledby="navbarDropdown" class="dropdown-menu">
                                        <a class="dropdown-item" href="#" onclick="exportCSV()">Timeline</a>
                                        <a class="dropdown-item" download="image.json" href="#" id="export-json"
                                           onclick="exportJSON()">GraphJSON</a>
                                        <!--    <a class="dropdown-item" download="case.json" href="#" id="caseexport-json"
                                               onclick="exportCaseJSON()">CaseJSON</a> -->
                                        <a class="dropdown-item" download="image.png" href="#" id="export-png"
                                           onclick="exportPNG()">PNG</a>
                                        <a class="dropdown-item" download="image.jpeg" href="#" id="export-jpeg"
                                           onclick="exportJPEG()">JPEG</a>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item">
                                <button class="btn btn-outline-primary" onclick="{
                                        document.getElementById('statsSideBar').classList.toggle('show')
                                    }" type="button">
                                    Stats
                                </button>
                            </li>
                            <li class="nav-item">
                                <div class="form-check form-switch ms-2">
                                    <label data-bs-placement="bottom" data-bs-toggle="tooltip"
                                           title="Switch to Darkmode">
                                        <input class="form-check-input" id="darkSwitch" type="checkbox">
                                        <label class="form-check-label" for="darkSwitch"></label>
                                    </label>
                                </div>
                                <script src="static/js/dark-mode-switch.min.js"></script>
                            </li>
                            <!-- Add more nav items here if needed -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row align-items-start">
            <div class="col-3 container pe-1 ps-1 sidebar dropdown-menu collapse overflow-auto" style="height: 92vh"
                 id="filterSideBar">
                <div class="row">
                    <div class="row pe-2 ps-2">
                        <button class="btn btn-success" data-bs-placement="bottom"
                                data-bs-toggle="tooltip"
                                onclick="createQuery()" title="Apply all selected filters below"
                                type="button">
                            Apply Filters
                        </button>
                    </div>
                    <hr>
                    <div class="row">
                        <label data-bs-placement="bottom" data-bs-toggle="tooltip"
                               title="If this is active only highlighted connections will be displayed. You can highlight edges permanently by holding CTRL and clicking on them.
This works also for hover elements - simply click on the element that highlights edges while holding
CTRL to have them highlighted permanently">
                            <input class="btn-check " id="highlightedEdgesOnly" type="checkbox">
                            <label class="btn btn-outline-secondary w-100"
                                   for="highlightedEdgesOnly">Highlighted</label>
                        </label>
                        <label data-bs-placement="bottom" data-bs-toggle="tooltip"
                               title="Decide if edges with same source and target are displayed">
                            <input class="btn-check " id="selfCon" type="checkbox">
                            <label class="btn btn-outline-secondary w-100" for="selfCon">ToSelf</label>
                        </label>
                    </div>
                    <hr>
                    <div class="container">
                        <div class="row">
                            <label class="col col-lg-10">
                                <input class="form-control w-100" id="queryUser"
                                       placeholder="User RegEx (history CTRL + Q)"
                                       type="text"
                                       value=""></label>
                            <label class="col-1" data-bs-placement="bottom" data-bs-toggle="tooltip"
                                   title="If active the matching Users will be excluded">
                                <input class="btn-check " id="invertUserRegex" type="checkbox">
                                <label class="btn btn-outline-danger" for="invertUserRegex">!</label>
                            </label>
                        </div>
                        <div class="row">
                            <label class="col-10">
                                <input class="form-control w-100" id="queryHostSrc"
                                       placeholder="Src Host RegEx (history CTRL + B)"
                                       type="text"
                                       value=""></label>
                            <label class="col-1" data-bs-placement="bottom" data-bs-toggle="tooltip"
                                   title="If active the matching source hosts will be excluded">
                                <input class="btn-check " id="invertSrcHostRegex" type="checkbox">
                                <label class="btn btn-outline-danger" for="invertSrcHostRegex">!</label>
                            </label>
                        </div>
                        <div class="row">
                            <label class="col-10">
                                <input class="form-control" id="queryHostDst"
                                       placeholder="Dst Host RegEx (history CTRL + Y)"
                                       type="text"
                                       value="">
                            </label>
                            <label class="col-1" data-bs-placement="bottom" data-bs-toggle="tooltip"
                                   title="If active the matching destination hosts will be excluded">
                                <input class="btn-check " id="invertDstHostRegex" type="checkbox">
                                <label class="btn btn-outline-danger" for="invertDstHostRegex">!</label>
                            </label>
                        </div>
                        <div class="row">
                            <label class="col-10">
                                <input class="form-control" id="queryDistinction"
                                       placeholder="Custom Distinction RegEx"
                                       type="text"
                                       value="">
                            </label>
                            <label class="col-1" data-bs-placement="bottom" data-bs-toggle="tooltip"
                                   title="If active the matching destination hosts will be excluded">
                                <input class="btn-check " id="invertDistinctionRegex" type="checkbox">
                                <label class="btn btn-outline-danger" for="invertDistinctionRegex">!</label>
                            </label>
                        </div>
                    </div>
                    <hr>
                    <div class="row mt-2">
                        <div class="col-5 align-self-center" data-bs-placement="bottom" data-bs-toggle="tooltip"
                             title="Specify a time zone that will be added
as an offset to the filters and timeline display
(time stamps in lists of nodes and edges will ramin Z Time)">
                            Display Time Offset
                        </div>
                        <div class="col-6">
                            <select id="timeOffsetList" class="form-select">
                                <option value="-12">UTC−12:00, Y</option>
                                <option value="-11">UTC−11:00, X</option>
                                <option value="-10">UTC−10:00, W</option>
                                <option value="-9.5">UTC−09:30, V†</option>
                                <option value="-9">UTC−09:00, V</option>
                                <option value="-8">UTC−08:00, U</option>
                                <option value="-7">UTC−07:00, T</option>
                                <option value="-6">UTC−06:00, S</option>
                                <option value="-5">UTC−05:00, R</option>
                                <option value="-4">UTC−04:00, Q</option>
                                <option value="-3.5">UTC−03:30, P†</option>
                                <option value="-3">UTC−03:00, P</option>
                                <option value="-2">UTC−02:00, O</option>
                                <option value="-1">UTC−01:00, N</option>
                                <option value="0" selected>UTC±00:00, Z</option>
                                <option value="1">UTC+01:00, A</option>
                                <option value="2">UTC+02:00, B</option>
                                <option value="3">UTC+03:00, C</option>
                                <option value="3.5">UTC+03:30, C†</option>
                                <option value="4">UTC+04:00, D</option>
                                <option value="4.5">UTC+04:30, D†</option>
                                <option value="5">UTC+05:00, E</option>
                                <option value="5.5">UTC+05:30, E†</option>
                                <option value="5.75">UTC+05:45, E*</option>
                                <option value="6">UTC+06:00, F</option>
                                <option value="6.5">UTC+06:30, F†</option>
                                <option value="7">UTC+07:00, G</option>
                                <option value="8">UTC+08:00, H</option>
                                <option value="8.75">UTC+08:45, H*</option>
                                <option value="9">UTC+09:00, I</option>
                                <option value="9.5">UTC+09:30, I†</option>
                                <option value="10">UTC+10:00, K</option>
                                <option value="10.5">UTC+10:30, K†</option>
                                <option value="11">UTC+11:00, L</option>
                                <option value="12">UTC+12:00, M</option>
                                <option value="12.75">UTC+12:45, M*</option>
                                <option value="13">UTC+13:00, M†</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="container">
                            <p class="col" data-bs-placement="bottom" data-bs-toggle="tooltip"
                               title="Specify a timeframe you want to filter for">Time Frame</p>
                            <div class="input-group fromdate col" data-target-input="nearest" id="datetimepicker1">
                                <input class="form-control datetimepicker-input" data-target="#datetimepicker1"
                                       id="from-date"
                                       placeholder="From"
                                       type="text"/>
                                <div class="input-group-text" data-target="#datetimepicker1"
                                     data-toggle="datetimepicker"><i class="far fa-calendar-alt"></i></div>
                            </div>
                            <div class="input-group todate col" data-target-input="nearest" id="datetimepicker2">
                                <input class="form-control datetimepicker-input" data-target="#datetimepicker2"
                                       id="to-date"
                                       placeholder="To"
                                       type="text"/>
                                <div class="input-group-text" data-target="#datetimepicker2"
                                     data-toggle="datetimepicker"><i class="far fa-calendar-alt"></i></div>
                            </div>
                            <script>
                                $('#datetimepicker1').datetimepicker({
                                    format: 'YYYY-MM-DDTHH:mm:ss',
                                });
                                $('#datetimepicker2').datetimepicker({
                                    format: 'YYYY-MM-DDTHH:mm:ss'
                                });
                            </script>
                            <div class="col">
                                <label class="row mt-1 ps-3 pe-3" data-bs-placement="bottom" data-bs-toggle="tooltip"
                                       title="Only display connections that happened on the weekend">
                                    <input class="btn-check" id="filterForWeekendsCkbx" type="checkbox">
                                    <label class="btn btn-outline-secondary" for="filterForWeekendsCkbx">
                                        Weekends only
                                    </label>
                                </label>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <a data-bs-placement="bottom" data-bs-toggle="tooltip"
                           title="Filter for events that happened during selected hours regardless of the day">
                            Time Frame (each day)
                        </a>
                        <div class="col-2 align-self-center">
                            From:
                        </div>
                        <div class="form-group mt-1 col-4">
                            <input class="form-control" id="from-clock" placeholder="From"
                                   type="time"/>
                        </div>
                        <div class="col-1 align-self-center">
                            To:
                        </div>
                        <div class="form-group mt-1 col-4">
                            <input class="form-control" id="to-clock" placeholder="To"
                                   type="time"/>
                        </div>
                    </div>
                    <hr>
                    <div class="row mb-1">
                        <div class="col-7 align-self-center">
                            Outgoing Connections:
                        </div>
                        <label class="col-5" data-bs-placement="bottom" data-bs-toggle="tooltip"
                               title="A threshold for the least amount of systems the source needs to have connections to. This happens after the other filers applied">
                            <input class="form-control cleanOnLoad" id="minOutgoingConnections"
                                   placeholder="Min Outgoing Connections"
                                   type="number"/>
                        </label>
                    </div>
                    <hr>
                    <div>
                        <a data-bs-placement="bottom" data-bs-toggle="tooltip"
                           title="Select Events to display">Events</a><br>
                        <form name="EventIDs">
                            <!--this is created via JS -->
                        </form>
                        <form name="LogonTypes" style="display: none">
                            <a>Logon Types</a>
                            <div class="row">
                            </div>
                        </form>
                    </div>
                    <hr>
                    <div>
                        <a data-bs-placement="bottom" data-bs-toggle="tooltip" title="Select Tags to display.">
                            <a data-bs-placement="bottom" data-bs-toggle="tooltip"
                               title="Select Events to display">Tags</a><br>
                            <form name="Tags">
                                <div class="row">
                                    <label data-bs-placement="top" data-bs-toggle="tooltip" title="Apply for all Tags">
                                        <input checked="checked" class="btn-check" id="applyAllTags" onclick="{
                            this.value = this.value === 'checked' ? 'unchecked' : 'checked'
                            for (const b of document.getElementsByClassName('tagBtns'))
                                b.checked = (this.value === 'checked')
                            document.getElementById('labelApplyAllTags').innerText = this.value === 'checked' ? 'Unselect all Tags' : 'Select all Tags'
                        }" type="checkbox"
                                               value="checked">
                                        <label class="btn btn-outline-secondary" for="applyAllTags"
                                               id="labelApplyAllTags">Unselect
                                            all Tags</label>
                                        <div class="row cleanOnLoad" id="tagFilterRow"></div>
                                    </label>
                                </div>
                            </form>
                        </a>
                    </div>
                    <div style="height: 5vh">
                    </div>
                </div>
            </div>

            <!--THE MAIN STAGE -->
            <div class="col main" style="height: 90vh" id="stage">
                <div id="timespan" style="height: 90vh; z-index: 1"
                     class="d-flex position-absolute align-items-start flex-column dynamic-display" title="
The timespan will only be displayed when the timespan selected in filters is below 3 months and
more than one day. It will show the amount of events per day in the selected timespan.
Weekends are highlighted in red and the width indicates the number of events written in the brackets ">
                </div>
                <div id="timeline" style="height: 90vh"
                     class="d-flex position-absolute container dynamic-display"></div>
                <div id="heatmap" style="height: 90vh"
                     class="d-flex position-absolute container dynamic-display"></div>
                <div id="innerStage" class="dynamic-display h-100">
                    <div id="cy" class="h-100">
                    </div>
                </div>
                <div id="loading">
                    <span class="fa fa-refresh fa-spin"></span>
                </div>
            </div>
            <div class="col-4 dropdown-menu position-absolute end-0 collapse overflow-auto" id="statsSideBar"
                 style="height: 90% !important;">
                <div class="container overflow-auto">
                    <br>
                    <details>
                        <summary><b>System Stats</b></summary>
                        <div class="scrollbar-young-passion">
                            <table class="table table-hover">
                                <thead>
                                <tr>
                                    <th scope="col">Name</th>
                                    <th scope="col">To Systems</th>
                                    <th scope="col">From Systems</th>
                                    <th scope="col">Users out</th>
                                    <th scope="col">Users in</th>
                                </tr>
                                </thead>
                                <tbody id="sysTable"></tbody>
                            </table>
                        </div>
                    </details>
                    <div class="container"></div>
                    <br>
                    <details>
                        <summary><b>User Stats</b></summary>
                        <table class="table table-hover scrollbar-young-passion">
                            <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">To Systems</th>
                            </tr>
                            </thead>
                            <tbody id="userTable"></tbody>
                        </table>
                    </details>
                </div>
            </div>
            <!-- THE STATS SIDEBAR -->
        </div>
    </div>
</div>
<!-- Modal -->
<div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="IP2HostConflict"
     role="dialog"
     tabindex="-1">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="hostConflictModalLabel"></h5>
            </div>
            <div class="modal-body">
                <div class="row" id="hostSelectionDiv">
                    <div aria-label="Basic radio toggle button group" class="btn-group"
                         id="hostSelectionRadioGroup"
                         role="group">
                    </div>
                </div>
            </div>
            <div class="input-group">
                <input class="form-control" id="customHost" placeholder="Custom Hostname" type="text">
                <button class="btn btn-primary" id="selectHostBtn" type="button">Set</button>
                <button class="btn btn-primary" id="cancelBtn" type="button">Skip</button>
                <button class="btn btn-danger" id="cancelAllBtn" type="button">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="searchHistory" role="dialog"
     tabindex="-1">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search History</h5>
            </div>
            <div class="modal-body">
                <div class="row" id="searchHistoryList"></div>
            </div>
        </div>
    </div>
</div>
<!-- Upload -->
<div class="modal fade" id="UploadEVTX" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Upload Event Log File</h4>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body" id="uploadBox">
                <p>Import the JSON file exported from the Lateral Movement Artefact.</p>
                <div class="row">
                    <div class="col-8">
                        <div class="input-group">
                            <input id="lefile" multiple style="display:none" type="file" onchange='{
                                let inFile = "";
                                let fileList = document.getElementById("lefile").files;
                                if (1 < fileList.length) {
                                    inFile += "selected " + fileList.length + " files."
                                } else {
                                    inFile += fileList[0].name
                                }
                                document.getElementById("evtx_name").value = inFile.replace("C:\\fakepath\\", "");
                            }'>
                            <input class="form-control" id="evtx_name" placeholder="select file (multi files) ..."
                                   type="text">
                            <span class="input-group-btn"><button class="btn btn-info"
                                                                  onclick="document.getElementById('lefile').click();"
                                                                  type="button">Browse</button></span>
                        </div>
                    </div>
                    <div id="uploadBar"></div>
                    <div id="status"></div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-8">
                        <div class="input-group">
                            <input id="clientInfoUpload" style="display:none" type="file" onchange='{
                              let inFile = "";
                                    let fileList = document.getElementById("clientInfoUpload").files;
                                    if (1 < fileList.length) {
                                        inFile += "selected " + fileList.length + " files."
                                    } else {
                                        inFile += fileList[0].name
                                    }
                                    document.getElementById("clientInfoFile").value = inFile.replace("C:\\fakepath\\", "");
                                                    }'>
                            <input class="form-control" id="clientInfoFile"
                                   placeholder="select client() output from velo"
                                   type="text">
                            <span class="input-group-btn"><button class="btn btn-info"
                                                                  onclick="document.getElementById('clientInfoUpload').click();"
                                                                  type="button">Browse</button></span>
                        </div>
                    </div>
                    <div id="uploadBarClient"></div>
                    <div id="statusClient"></div>
                </div>
                <hr>

                <p>Upload CSV with Hostname IP Mapping (optional).</p>
                <div class="row">
                    <div class="col-5">
                        <div class="input-group">
                            <input id="hostipmap" onchange="{
                                    if (this.files)
                                   document.getElementById('mapProcessBtn').disabled = false

                            let inFile ='';
                            let fileList = document.getElementById('hostipmap').files;
                            if (1 < fileList.length) {
                            inFile += 'selected ' + fileList.length + ' files.'
                            } else {
                            inFile += fileList[0].name
                            }
                            document.getElementById('mapname').value = inFile.replace('C:\\fakepath\\', '');
                            }" style="display:none" type="file">
                            <input class="form-control" id="mapname" placeholder="select file ..."
                                   type="text">
                            <span class="input-group-btn"><button class="btn btn-info" id="mapnameBtn"
                                                                  onclick="document.getElementById('hostipmap').click();"
                                                                  type="button">Browse</button></span>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="input-group">
                            <input class="form-control" id="hostMapDelimiter" placeholder="Delimiter (,)"
                                   type="text">
                            <span class="input-group-btn"><button class="btn btn-info" disabled id="mapProcessBtn"
                                                                  onclick="mapPrePorcessBtnClick()"
                                                                  type="button">Load Map</button></span>
                        </div>
                    </div>
                </div>
                <div class="row" id="csvFields">

                </div>
                <div class="modal-footer" id="uploadButtons">
                    <button id="uploadBtn" class="btn btn-primary" onclick="fileUpload()" type="submit">Upload
                    </button>
                    <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Warning message -->
<div class="modal fade" id="graphWarning" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">WARNING!</h4>
            </div>
            <div class="modal-body">
                <p>The number of Nodes and Edges likely crashes Blauhaunt! Are you sure you want to proceed?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal" onclick='{
                drawGraph({nodes: filtered_nodes, edges: filtered_edges}, "")
                document.getElementById("innerStage").classList.remove("d-none")
                document.getElementById("timespan").classList.remove("d-none")
                }' type="button">Yes
                </button>
                <button class="btn btn-primary" data-bs-dismiss="modal" type="button">No</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    let serverSvgPath = "static/images/font-awesome/server.svg"
    let desktopSvgPath = "static/images/font-awesome/desktop.svg"
    let userSvgPath = "static/images/font-awesome/user.svg"
</script>
<script src="static/js/script.js"></script>
<script src="static/js/veloAPI.js"></script>
</body>

</html>
